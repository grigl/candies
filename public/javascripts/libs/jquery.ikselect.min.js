(function($){
 $.fn.extend({

 	customSelect : function(options) {
	  if(!$.browser.msie || ($.browser.msie&&$.browser.version>6)){
	  return this.each(function() {

			var currentSelected = $(this).find(':selected');
			var sortedVals = $.makeArray($(this).find('option')).sort(function(a,b){
					return parseInt($(a).text()) > parseInt($(b).text()) ? 1 : parseInt($(a).text()) < parseInt($(b).text()) ? -1 : 0 ;
			});
			$(this).empty().html(sortedVals).find(':first').attr('selected','selected');
			$(this).parent().find('span.select').remove();
			$(this).after('<span class="select"><span class="select-text">'+currentSelected.text()+'</span></span>').css({position:'absolute', opacity:0, fontSize:$(this).next().css('font-size')});
			var selectBoxSpan = $(this).next();
			var selectBoxWidth = selectBoxSpan.width();
			var selectBoxSpanInner = selectBoxSpan.find(':first-child');
			selectBoxSpanInner.css({display:'inline-block'});
			$(this).css({width: selectBoxWidth + 2});
			var selectBoxHeight = parseInt(selectBoxSpan.height()) + parseInt(selectBoxSpan.css('padding-top')) + parseInt(selectBoxSpan.css('padding-bottom'));
			$(this).height(selectBoxHeight).change(function(){
				selectBoxSpanInner.text($('option:selected',this).text()).parent().addClass('changed');
			});
			var old_value = $(this).val();
			$(this).next().find('span').html(old_value);

	  });
	  }
	}
 });
})(jQuery);